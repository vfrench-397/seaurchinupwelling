---
title: "Sea-urchin-Upwelling-HW2"
output: html_document
---


Title: 
Authors: 
Victoria French
Madison Pacaro 
Jamie Poirier 


# Introduction 



# Version Control


R version 4.0.3 was used for all analyses. 
DESeq2 package version 1.30.1
affycoretools package version 1.62.0
arrayQualityMetrics package version 3.46.0
genefilter package version 1.72.1
Biobase package version 2.50.0


# Data Analysis & Methods

First, we loaded all the required packages for our analyses.
```{r, warning=FALSE, message=FALSE}

#DESeq 
library(DESeq2) 
library(affycoretools)
library(arrayQualityMetrics)
library(genefilter)
library(Biobase)

#GO

#WGCNA

```

We then set our working directory for the project.
```{r, results='hide'}
setwd("C:/Users/Maddy/Documents/BI586/seaurchinupwelling")

```

Next, we read in our raw count data, and determined the length of the data. 
```{r}
countData <- read.table("geneCounts_02122019.txt")
head(countData)
length(countData[,1])
```

The length of our data is 30284. This is the number of genes we have represented in our data set.

We then remaned our data by our two treatments: NN = non-upwelling and UU = upwelling conditions.
```{r}
names(countData)=c("NN", "NN", "NN", "UU", "UU", "UU")
head(countData)
```


# Outlier Analysis

We then conducted array quality metrics to detect and remove outliers in our data. We first specified a new directory for outlier data and our treatments.
```{r}
setwd("C:/Users/Maddy/Documents/BI586/seaurchinupwelling/outlier")
v=setwd("C:/Users/Maddy/Documents/BI586/seaurchinupwelling/outlier")
treat=c("NN", "NN", "NN", "UU", "UU", "UU")
```

Here, we are creating colData, which is a data frame associating sample with treatment.
```{r}
g=data.frame(treat)
g
colData=g
```

We now are calling on DESeq2 to create a model for our data, which is storing the results of analysis of differential expression and asking how our design varies by treatment. We then normalized our data.
```{r}

dds=DESeqDataSetFromMatrix(countData=countData,
                           colData = g,
                           design = ~treat)
vsd.ge=assay(vst(dds))
rl=vst(dds)
```

Using arrayQualityMetrics, we then identified any outliers in our data. We have an outlier in UU detected under "Distances between arrays." We will be keeping this outlier in our data because it was only offensive in distance between arrays, but not in boxplots or MA plots. Based on the barplot of our total counts data below, we will see even distribution between our treatments, which is another reason we are keeping this outlier.

#show html file here

```{r}
e=ExpressionSet(assay(rl), AnnotatedDataFrame(as.data.frame(colData(rl))))
arrayQualityMetrics(e,outdir=v,intgroup=c("treat"),force=T)
```

```{r}
```

```{r}

```


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```




